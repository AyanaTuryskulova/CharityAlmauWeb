# Backend Architecture — Chat & Rentals

## Chat module
Сообщения хранятся в модели `Message`, каждая запись связана с чатом (`Chat`) и пользователем (`User`).

### Основная логика:
- При первом взаимодействии между пользователями создаётся объект `Chat`.
- Все сообщения между этими пользователями сохраняются в `Message` с внешним ключом на `Chat`.
- Поле `is_read` используется для отображения непрочитанных сообщений.
- Удаление чата удаляет все связанные сообщения.

### Ключевые таблицы:
| Таблица | Описание |
|----------|-----------|
| **Chat** | Содержит участников чата (M2M с User) |
| **Message** | Содержит текст, время и статус каждого сообщения |

---

## Rentals module
Аренда хранится в модели `RentItem`, которая связывает `Product` и `User`.  
Каждая запись в таблице `RentItem` отражает одну аренду (начало, конец, статус).

### Основная логика:
- При начале аренды создаётся `RentItem` с `status="rented"`.
- После завершения — `status="returned"`.
- При отмене — `status="cancelled"`.
- Все активные аренды пользователя фильтруются по `renter_id` и `status`.

### Ключевые таблицы:
| Таблица | Описание |
|----------|-----------|
| **RentItem** | Информация об аренде: товар, арендатор, статус, даты |
| **Product** | Товар, который может быть арендован |
| **User** | Пользователь, владелец и арендатор |
